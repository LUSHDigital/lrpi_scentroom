(this["webpackJsonplush-file-uploader"]=this["webpackJsonplush-file-uploader"]||[]).push([[0],{11:function(e,t,n){e.exports=n(19)},17:function(e,t,n){},18:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(2),o=n(4),i=n(3),c=n(5),l=n(0),s=n.n(l),u=n(10),f=n.n(u);n(8),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var p=n(6),d=n.n(p),m=n(7),h=(n(17),{TEST_START:0,TEST_IN_PROGRESS:1,TEST_KILL:2}),g=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,c=new Array(r),l=0;l<r;l++)c[l]=arguments[l];return(n=Object(o.a)(this,(e=Object(i.a)(t)).call.apply(e,[this].concat(c)))).state={runTest:!1},n.sendCommand=function(e){if(e===h.TEST_START){n.props.notificationManager.current.openNotification("The test is warming up...");var t=n.props.endpoint+"/test-start";fetch(t,{method:"GET"}).then((function(){n.props.notificationManager.current.openNotification("Test is running!")})).catch((function(e){return console.log(e)})),n.setState({runTest:!0})}else if(e===h.TEST_KILL){var a=n.props.endpoint+"/test-kill";fetch(a,{method:"GET"}).then((function(){n.props.notificationManager.current.openNotification("Test cancelled")})).catch((function(e){return console.log(e)})),n.setState({runTest:!1})}},n.triggerTest=function(e){e===h.TEST_START?(console.log("Test running!"),n.sendCommand(e)):e===h.TEST_KILL&&(console.log("End of test..."),n.sendCommand(e))},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{onTouchStart:function(){return e.triggerTest(h.TEST_START)},onTouchEnd:function(){return e.triggerTest(h.TEST_KILL)},onMouseDown:function(){return e.triggerTest(h.TEST_START)},onMouseUp:function(){return e.triggerTest(h.TEST_KILL)},className:"inputbtn"},this.state.runTest?s.a.createElement("span",null,"Release to end"):s.a.createElement("span",null,"Press + hold to test")))}}]),t}(s.a.Component),b=(n(18),function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).openNotification=function(e){n.setState({isActive:!0,message:e}),n.timer=window.setTimeout((function(){n.setState({isActive:!1,message:""})}),8e3)},n.state={timer:null,isActive:!1,message:""},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return this.state.isActive?s.a.createElement("div",{className:"notification"},s.a.createElement("div",{className:"notification-body"},this.state.message)):null}}]),t}(l.PureComponent)),E="dev"===Object({NODE_ENV:"production",PUBLIC_URL:""}).REACT_APP_STAGE?"http://192.168.0.56:5000":window.location.origin,T=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(o.a)(this,Object(i.a)(t).call(this,e))).notificationRef=s.a.createRef(),n.fileChangeHandler=function(e){var t=e.target.files[0];n.setState({selectedFile:t})},n.colorChangeHandler=function(e){var t=e.target.value;n.setState({selectedCol:t})},n.handleSubmit=function(e){e.preventDefault();var t=new FormData;t.append("file",n.state.selectedFile),t.append("colour",n.state.selectedCol);var a=n.uploadFile(t),r=n.uploadCol(t);a&&r?(console.log("Response from notification manager: ",a,r),n.notificationManager("Upload success")):a||r?!a&&r?n.notificationManager("Error: Failed to upload colour"):a||r||n.notificationManager("Error: Upload failed"):(console.log("Response from notification manager: ",a,r),n.notificationManager("Error: Failed to upload audio file"))},n.distanceHandlerActive=function(){n.notificationManager("Warming up the room..."),n.endpointRequest(!0).then((function(e){e?n.notificationManager("Success: Activated"):n.notificationManager("Error: Could not activate")})).catch((function(e){console.log("Something went horribly wrong...")}))},n.distanceHandlerDeactive=function(){n.notificationManager("Ending the test..."),n.endpointRequest(!1)?n.notificationManager("Success: Deactivated"):n.notificationManager("Error: Could not deactivate")},n.endpointRequest=function(){var e=Object(m.a)(d.a.mark((function e(t){var n,a,r;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("epr: ",t),n="",""===(n=t?E+"/test-start":E+"/test-kill")){e.next=13;break}return e.next=6,fetch(n,{headers:{"Content-Type":"application/json"}});case 6:return a=e.sent,e.next=9,a.json();case 9:if(r=e.sent,console.log("json res: ",r),null==r||200!==r.response){e.next=13;break}return e.abrupt("return",!0);case 13:return e.abrupt("return",!1);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.uploadFile=function(){var e=Object(m.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E+"/upload-file",e.next=3,fetch(n,{method:"POST",body:t});case 3:if(null==(a=e.sent)||200!==a.response){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.uploadCol=function(){var e=Object(m.a)(d.a.mark((function e(t){var n,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=E+"/upload-colour",e.next=3,fetch(n,{method:"POST",body:t});case 3:if(null==(a=e.sent)||200!==a.response){e.next=6;break}return e.abrupt("return",!0);case 6:return e.abrupt("return",!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n.state={selectedFile:null,selectedCol:"#011993"},n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"notificationManager",value:function(e){this.notificationRef.current.openNotification(e)}},{key:"render",value:function(){return s.a.createElement("div",{className:"form_body"},s.a.createElement("form",{onSubmit:this.handleSubmit},s.a.createElement("label",null,"Select Music File"),s.a.createElement("br",null),s.a.createElement("input",{type:"file",id:"fileinput",name:"file",accept:".mp3,.mp4;",onChange:this.fileChangeHandler}),s.a.createElement("br",null),s.a.createElement("label",null,"Select Colour"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("input",{type:"color",name:"colour",onChange:this.colorChangeHandler,value:this.state.selectedCol})," ",s.a.createElement("br",null),s.a.createElement("input",{type:"submit",value:"Upload",className:"inputbtn"})),s.a.createElement("div",{className:"test-button"},s.a.createElement(g,{endpoint:E,notificationManager:this.notificationRef})),s.a.createElement("br",null),s.a.createElement("button",{className:"tempSensorBtn",onClick:this.distanceHandlerActive}," Start test"),s.a.createElement("button",{className:"tempSensorBtn",onClick:this.distanceHandlerDeactive}," End test"),s.a.createElement("br",null),s.a.createElement(b,{ref:this.notificationRef}))}}]),t}(s.a.Component),v=function(e){function t(){return Object(a.a)(this,t),Object(o.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("div",{className:"layout_header"},s.a.createElement("h1",null,"ScentRoom Uploader")),s.a.createElement(T,null))}}]),t}(s.a.Component);f.a.render(s.a.createElement(v,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){}},[[11,1,2]]]);
//# sourceMappingURL=main.4b1e8108.chunk.js.map